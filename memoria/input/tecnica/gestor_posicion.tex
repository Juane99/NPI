\section{Gestor Posición}

Debido a que varias secciones de nuestro código necesitaban tanto permiso, como funcionalidades relativas a la posición del dispositivo, decidimos crear esta clase con la que poder gestionar este apartado sin tener que repetir código en las distintas clases del proyecto.


Esta clase cuenta con cuatro métodos que son los que hemos utilizado en todo el proyecto.

\begin{itemize}
	\item \texttt{actualizarPosActual(contexto, actividad, mapa)}: Dado un contexto, una actividad y un mapa, actualizar la posición en el mapa dado a la posición actual del dispositivo.
	\item \texttt{rotarMapa(mapa, rotación)}: Dado un mapa, rotar el mapa \texttt{rotación} grados, de forma que el mapa apunte a una orientación dada.
	\item \texttt{getPuedoAccederLoc()}: Devuelve verdadero si puede acceder a la localización del dispositivo, falso en otro caso.
	\item \texttt{posicionMasCercana(posiciones, contexto, actividad)}: Dada una lista de posiciones, devuelve el indice de la más cercana con respecto a la posición del dispositivo.
\end{itemize}


\subsubsection{Método actualizarPosActual}

Este método simplmente utiliza la clase \texttt{LocationServices}\cite{locationServices} para obtener la posición del dispositivo, y si puede acceder, centra el mapa dado a dicha posición, además de añadir un marcador de la posición actual.


\subsubsection{Método rotarMapa}

Haciendo uso de la clase \texttt{CameraPosition}\cite{cameraPosition} de la API de Google Maps, clona los valores de la posición de la camara actual, pero cambiando el atributo \texttt{bearing}, el cual corresponde a la rotación.

Aplica los cambios utilizando el método \texttt{animateCamara}, de forma que si el cambio es brusco aparece como una animación.

\subsubsection{Método getPuedoAccederLoc}

Simplemente devuelve si puede acceder a la ubicación del dispositivo. Verdadero si puedo, falso si no, ya sea por falta de permisos, o porque el dispositivo tiene la localización desactivada.

\subsubsection{Método posicionMasCercana}

Este método obtiene la posición actual, e itera sobre el vector de posiciones dado para encontrar la posición dada más cercana utilizando el método \texttt{distanceBetween} de la clase \texttt{Location}\cite{locationAndroid} de Android.



